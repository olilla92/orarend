<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Órarend</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #53dbd4; }
    .nap { margin-bottom: 30px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    h2 { margin-top: 0; }
    h1 { text-align: center; font-style: italic; text-transform: uppercase;}
    .tantargy { display: flex; align-items: center; justify-content: space-between; margin: 8px 0; }
    input { margin-right: 10px; }
    button { margin-left: 5px;}
  </style>
</head>
<body>
  <h1>Heti órarend</h1>
  <div id="orarend"></div>

  <script>
    const API_URL = "http://localhost:3000/orarend";

async function lekerOrarend() {
  const res = await fetch(API_URL);
  const data = await res.json();
  megjelenitOrarend(data);
}

function megjelenitOrarend(adatok) {
  const kontener = document.getElementById("orarend");
  kontener.innerHTML = "";

  for (const nap in adatok) {
    const napDiv = document.createElement("div");
    napDiv.className = "nap";

    const cim = document.createElement("h2");
    cim.textContent = nap.charAt(0).toUpperCase() + nap.slice(1);
    napDiv.appendChild(cim);

    const napAdatok = adatok[nap];

    napAdatok.forEach(({ ora, tantargy }) => {
      const sor = document.createElement("div");
      sor.className = "tantargy";

      const szoveg = document.createElement("span");
      szoveg.textContent = `${ora}. óra: ${tantargy}`;

      const torles = document.createElement("button");
      torles.textContent = "Törlés";
      torles.onclick = async () => {
        await fetch(`${API_URL}/${nap}/${ora}`, { method: "DELETE" });
        lekerOrarend();
      };

      const szerkeszt = document.createElement("button");
      szerkeszt.textContent = "Szerkesztés";
      szerkeszt.onclick = async () => {
        const ujNev = prompt("Új tantárgy neve:", tantargy);
        if (ujNev) {
          await fetch(`${API_URL}/${nap}/${ora}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ tantargy: ujNev })
          });
          lekerOrarend();
        }
      };

      sor.append(szoveg, szerkeszt, torles);
      napDiv.appendChild(sor);
    });

    const oraInput = document.createElement("input");
    oraInput.placeholder = "Óraszám (pl. 6)";
    oraInput.type = "number";

    const tantargyInput = document.createElement("input");
    tantargyInput.placeholder = "Tantárgy neve";

    const hozzaad = document.createElement("button");
    hozzaad.textContent = "Hozzáadás";
    hozzaad.onclick = async () => {
      const ora = parseInt(oraInput.value);
      const tantargy = tantargyInput.value.trim();
      if (ora && tantargy) {
        await fetch(`${API_URL}/${nap}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ ora, tantargy })
        });
        lekerOrarend();
      }
    };

    napDiv.append(oraInput, tantargyInput, hozzaad);
    kontener.appendChild(napDiv);
  }
}

lekerOrarend();

  </script>
</body>
</html>

